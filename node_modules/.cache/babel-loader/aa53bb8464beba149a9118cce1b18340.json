{"ast":null,"code":"import _slicedToArray from\"/Users/aleksandrmalyh/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./App.css\";import React,{useState,useEffect}from\"react\";import{Routes,Route,useNavigate}from\"react-router-dom\";import*as Auth from\"../../utils/auth\";import{ProtectedRoute}from\"../ProtectedRoute/ProtectedRoute\";import{api}from\"../../utils/api\";import{Register}from\"../Registrer/Register\";import{Login}from\"../Login/Login\";import{ErrorNotFound}from\"../NotFoundError/NotFoundError\";import{Main}from\"../Main/Main\";import{Movies}from\"../Movies/Movies\";import{Navigation}from\"../Navigation/Navigation\";import{SavedMovies}from\"../SavedMovies/SavedMovies\";import{Profile}from\"../Profile/Profile\";import{CurrentUserContext}from\"../../context/CurrentUserContext\";import{isLoggedInContext}from\"../../context/IsLoggedInContext\";import{InfoToolTip}from\"../Popup/Popup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var App=function App(){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loggedIn=_useState2[0],setLoggedIn=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),currentUser=_useState4[0],setCurrentUser=_useState4[1];//поп-ап с подсказкой\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isInfoToolTipOpened=_useState6[0],setIsInfoToolTipOpened=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isSuccseed=_useState8[0],setSuccseed=_useState8[1];//получаю данные пользователя\nuseEffect(function(){var token=localStorage.getItem(\"token\");if(token){api.getUserInfo(token).then(function(userData){setLoggedIn(true);setCurrentUser(userData);}).catch(function(err){return console.log(err);});}},[loggedIn]);var handleUpdateUser=function handleUpdateUser(_ref){var name=_ref.name,email=_ref.email;var token=localStorage.getItem('token');api.setUserInfo(name,email,token).then(function(userData){setCurrentUser(userData);closeAllPopups();}).catch(function(error){console.log(error);});};var onRegister=function onRegister(_ref2){var email=_ref2.email,password=_ref2.password,name=_ref2.name;return Auth.register(email,password,name).then(function(res){if(res){setSuccseed(true);setIsInfoToolTipOpened(true);navigate(\"/movies\");}else{setSuccseed(false);setIsInfoToolTipOpened(true);}});};var onLogin=function onLogin(_ref3){var email=_ref3.email,password=_ref3.password;return Auth.login(email,password).then(function(res){if(res){localStorage.setItem(\"token\",res.token);setLoggedIn(true);navigate(\"/movies\");}else{setLoggedIn(false);setSuccseed(false);setIsInfoToolTipOpened(true);}}).catch(function(err){return console.log(err);});};var onSignOut=function onSignOut(){localStorage.clear();setLoggedIn(false);navigate(\"/\");};var closeAllPopups=function closeAllPopups(){setIsInfoToolTipOpened(false);};return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsx(isLoggedInContext.Provider,{value:loggedIn,children:/*#__PURE__*/_jsxs(\"div\",{className:\"root\",children:[/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(ErrorNotFound,{})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Main,{loggedIn:loggedIn})}),/*#__PURE__*/_jsx(Route,{path:\"/sign-in\",element:/*#__PURE__*/_jsx(Login,{onLogin:onLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/sign-up\",element:/*#__PURE__*/_jsx(Register,{onRegister:onRegister})}),/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(ProtectedRoute,{loggedIn:loggedIn}),children:[/*#__PURE__*/_jsx(Route,{path:\"/movies\",element:/*#__PURE__*/_jsx(Movies,{})}),/*#__PURE__*/_jsx(Route,{path:\"/saved-movies\",element:/*#__PURE__*/_jsx(SavedMovies,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{onUpdateUser:handleUpdateUser,onSignOut:onSignOut})}),/*#__PURE__*/_jsx(Route,{path:\"nav-test\",element:/*#__PURE__*/_jsx(Navigation,{})})]})]}),/*#__PURE__*/_jsx(InfoToolTip,{id:\"reg-pic\",isOpened:isInfoToolTipOpened,onClose:closeAllPopups,isSuccseed:isSuccseed})]})})});};","map":{"version":3,"sources":["/Users/aleksandrmalyh/dev/movies-explorer-frontend/src/components/App/App.js"],"names":["React","useState","useEffect","Routes","Route","useNavigate","Auth","ProtectedRoute","api","Register","Login","ErrorNotFound","Main","Movies","Navigation","SavedMovies","Profile","CurrentUserContext","isLoggedInContext","InfoToolTip","App","navigate","loggedIn","setLoggedIn","currentUser","setCurrentUser","isInfoToolTipOpened","setIsInfoToolTipOpened","isSuccseed","setSuccseed","token","localStorage","getItem","getUserInfo","then","userData","catch","err","console","log","handleUpdateUser","name","email","setUserInfo","closeAllPopups","error","onRegister","password","register","res","onLogin","login","setItem","onSignOut","clear"],"mappings":"wIAAA,MAAO,WAAP,CACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,MAAT,CAAiBC,KAAjB,CAAwBC,WAAxB,KAA2C,kBAA3C,CACA,MAAO,GAAKC,CAAAA,IAAZ,KAAsB,kBAAtB,CACA,OAASC,cAAT,KAA+B,kCAA/B,CACA,OAASC,GAAT,KAAoB,iBAApB,CACA,OAASC,QAAT,KAAyB,uBAAzB,CACA,OAASC,KAAT,KAAsB,gBAAtB,CACA,OAASC,aAAT,KAA8B,gCAA9B,CACA,OAASC,IAAT,KAAqB,cAArB,CACA,OAASC,MAAT,KAAuB,kBAAvB,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,OAASC,WAAT,KAA4B,4BAA5B,CACA,OAASC,OAAT,KAAwB,oBAAxB,CACA,OAASC,kBAAT,KAAmC,kCAAnC,CACA,OAASC,iBAAT,KAAkC,iCAAlC,CACA,OAASC,WAAT,KAA4B,gBAA5B,C,wFAEA,MAAO,IAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CACvB,GAAIC,CAAAA,QAAQ,CAAGhB,WAAW,EAA1B,CAEA,cAAgCJ,QAAQ,CAAC,KAAD,CAAxC,wCAAOqB,QAAP,eAAiBC,WAAjB,eACA,eAAsCtB,QAAQ,CAAC,EAAD,CAA9C,yCAAOuB,WAAP,eAAoBC,cAApB,eAEA;AACA,eAAsDxB,QAAQ,CAAC,KAAD,CAA9D,yCAAOyB,mBAAP,eAA4BC,sBAA5B,eACA,eAAkC1B,QAAQ,CAAC,IAAD,CAA1C,yCAAO2B,UAAP,eAAmBC,WAAnB,eAGA;AACA3B,SAAS,CAAC,UAAM,CACd,GAAM4B,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACA,GAAIF,KAAJ,CAAW,CACTtB,GAAG,CACAyB,WADH,CACeH,KADf,EAEGI,IAFH,CAEQ,SAACC,QAAD,CAAc,CAClBZ,WAAW,CAAC,IAAD,CAAX,CACAE,cAAc,CAACU,QAAD,CAAd,CACD,CALH,EAMGC,KANH,CAMS,SAACC,GAAD,QAASC,CAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAAT,EANT,EAOD,CACF,CAXQ,CAWN,CAACf,QAAD,CAXM,CAAT,CAaA,GAAMkB,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,MAAqB,IAAlBC,CAAAA,IAAkB,MAAlBA,IAAkB,CAAZC,KAAY,MAAZA,KAAY,CAC5C,GAAMZ,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACAxB,GAAG,CACAmC,WADH,CACeF,IADf,CACqBC,KADrB,CAC4BZ,KAD5B,EAEGI,IAFH,CAEQ,SAACC,QAAD,CAAc,CAClBV,cAAc,CAACU,QAAD,CAAd,CACAS,cAAc,GACf,CALH,EAMGR,KANH,CAMS,SAACS,KAAD,CAAW,CAChBP,OAAO,CAACC,GAAR,CAAYM,KAAZ,EACD,CARH,EASD,CAXD,CAaA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,OAA+B,IAA5BJ,CAAAA,KAA4B,OAA5BA,KAA4B,CAArBK,QAAqB,OAArBA,QAAqB,CAAXN,IAAW,OAAXA,IAAW,CAChD,MAAOnC,CAAAA,IAAI,CAAC0C,QAAL,CAAcN,KAAd,CAAqBK,QAArB,CAA+BN,IAA/B,EAAqCP,IAArC,CAA0C,SAACe,GAAD,CAAS,CACxD,GAAIA,GAAJ,CAAS,CACPpB,WAAW,CAAC,IAAD,CAAX,CACAF,sBAAsB,CAAC,IAAD,CAAtB,CACAN,QAAQ,CAAC,SAAD,CAAR,CACD,CAJD,IAIO,CACLQ,WAAW,CAAC,KAAD,CAAX,CACAF,sBAAsB,CAAC,IAAD,CAAtB,CACD,CACF,CATM,CAAP,CAUD,CAXD,CAaA,GAAMuB,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,OAAyB,IAAtBR,CAAAA,KAAsB,OAAtBA,KAAsB,CAAfK,QAAe,OAAfA,QAAe,CACvC,MAAOzC,CAAAA,IAAI,CAAC6C,KAAL,CAAWT,KAAX,CAAkBK,QAAlB,EACJb,IADI,CACC,SAACe,GAAD,CAAS,CACb,GAAIA,GAAJ,CAAS,CACPlB,YAAY,CAACqB,OAAb,CAAqB,OAArB,CAA8BH,GAAG,CAACnB,KAAlC,EACAP,WAAW,CAAC,IAAD,CAAX,CACAF,QAAQ,CAAC,SAAD,CAAR,CACD,CAJD,IAIO,CACLE,WAAW,CAAC,KAAD,CAAX,CACAM,WAAW,CAAC,KAAD,CAAX,CACAF,sBAAsB,CAAC,IAAD,CAAtB,CACD,CACF,CAXI,EAYJS,KAZI,CAYE,SAACC,GAAD,QAASC,CAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAAT,EAZF,CAAP,CAaD,CAdD,CAgBA,GAAMgB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtBtB,YAAY,CAACuB,KAAb,GACA/B,WAAW,CAAC,KAAD,CAAX,CACAF,QAAQ,CAAC,GAAD,CAAR,CACD,CAJD,CAMA,GAAMuB,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3BjB,sBAAsB,CAAC,KAAD,CAAtB,CACD,CAFD,CAIA,mBACE,KAAC,kBAAD,CAAoB,QAApB,EAA6B,KAAK,CAAEH,WAApC,uBACE,KAAC,iBAAD,CAAmB,QAAnB,EAA4B,KAAK,CAAEF,QAAnC,uBACE,aAAK,SAAS,CAAC,MAAf,wBACE,MAAC,MAAD,yBACA,KAAC,KAAD,EAAO,IAAI,CAAC,GAAZ,CAAgB,OAAO,cAAE,KAAC,aAAD,IAAzB,EADA,cAEE,KAAC,KAAD,EAAO,IAAI,CAAC,GAAZ,CAAgB,OAAO,cAAE,KAAC,IAAD,EAAM,QAAQ,CAAEA,QAAhB,EAAzB,EAFF,cAGE,KAAC,KAAD,EAAO,IAAI,CAAC,UAAZ,CAAuB,OAAO,cAAE,KAAC,KAAD,EAAO,OAAO,CAAE4B,OAAhB,EAAhC,EAHF,cAIE,KAAC,KAAD,EACE,IAAI,CAAC,UADP,CAEE,OAAO,cAAE,KAAC,QAAD,EAAU,UAAU,CAAEJ,UAAtB,EAFX,EAJF,cASE,MAAC,KAAD,EAAO,OAAO,cAAE,KAAC,cAAD,EAAgB,QAAQ,CAAExB,QAA1B,EAAhB,wBACE,KAAC,KAAD,EAAO,IAAI,CAAC,SAAZ,CAAsB,OAAO,cAAE,KAAC,MAAD,IAA/B,EADF,cAEE,KAAC,KAAD,EAAO,IAAI,CAAC,eAAZ,CAA4B,OAAO,cAAE,KAAC,WAAD,IAArC,EAFF,cAGE,KAAC,KAAD,EAAO,IAAI,CAAC,UAAZ,CAAuB,OAAO,cAAE,KAAC,OAAD,EAChC,YAAY,CAAEkB,gBADkB,CAE5B,SAAS,CAAEa,SAFiB,EAAhC,EAHF,cAOE,KAAC,KAAD,EAAO,IAAI,CAAC,UAAZ,CAAuB,OAAO,cAAE,KAAC,UAAD,IAAhC,EAPF,GATF,GADF,cAqBE,KAAC,WAAD,EACE,EAAE,CAAC,SADL,CAEE,QAAQ,CAAE3B,mBAFZ,CAGE,OAAO,CAAEkB,cAHX,CAIE,UAAU,CAAEhB,UAJd,EArBF,GADF,EADF,EADF,CAkCD,CA/GM","sourcesContent":["import \"./App.css\";\nimport React, { useState, useEffect } from \"react\";\nimport { Routes, Route, useNavigate } from \"react-router-dom\";\nimport * as Auth from \"../../utils/auth\";\nimport { ProtectedRoute } from \"../ProtectedRoute/ProtectedRoute\";\nimport { api } from \"../../utils/api\";\nimport { Register } from \"../Registrer/Register\";\nimport { Login } from \"../Login/Login\";\nimport { ErrorNotFound } from \"../NotFoundError/NotFoundError\";\nimport { Main } from \"../Main/Main\";\nimport { Movies } from \"../Movies/Movies\";\nimport { Navigation } from \"../Navigation/Navigation\";\nimport { SavedMovies } from \"../SavedMovies/SavedMovies\";\nimport { Profile } from \"../Profile/Profile\";\nimport { CurrentUserContext } from \"../../context/CurrentUserContext\";\nimport { isLoggedInContext } from \"../../context/IsLoggedInContext\";\nimport { InfoToolTip } from \"../Popup/Popup\";\n\nexport const App = () => {\n  let navigate = useNavigate();\n\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState({});\n\n  //поп-ап с подсказкой\n  const [isInfoToolTipOpened, setIsInfoToolTipOpened] = useState(false);\n  const [isSuccseed, setSuccseed] = useState(true);\n\n  \n  //получаю данные пользователя\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      api\n        .getUserInfo(token)\n        .then((userData) => {\n          setLoggedIn(true);\n          setCurrentUser(userData);\n        })\n        .catch((err) => console.log(err));\n    }\n  }, [loggedIn]);\n\n  const handleUpdateUser = ({ name, email }) => {\n    const token = localStorage.getItem('token');\n    api\n      .setUserInfo(name, email, token)\n      .then((userData) => {\n        setCurrentUser(userData);\n        closeAllPopups();\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  const onRegister = ({ email, password, name }) => {\n    return Auth.register(email, password, name).then((res) => {\n      if (res) {\n        setSuccseed(true);\n        setIsInfoToolTipOpened(true);\n        navigate(\"/movies\");\n      } else {\n        setSuccseed(false);\n        setIsInfoToolTipOpened(true);\n      }\n    });\n  };\n\n  const onLogin = ({ email, password }) => {\n    return Auth.login(email, password)\n      .then((res) => {\n        if (res) {\n          localStorage.setItem(\"token\", res.token);\n          setLoggedIn(true);\n          navigate(\"/movies\");\n        } else {\n          setLoggedIn(false);\n          setSuccseed(false);\n          setIsInfoToolTipOpened(true);\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n\n  const onSignOut = () => {\n    localStorage.clear();\n    setLoggedIn(false);\n    navigate(\"/\");\n  };\n\n  const closeAllPopups = () => {\n    setIsInfoToolTipOpened(false);\n  };\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <isLoggedInContext.Provider value={loggedIn}>\n        <div className=\"root\">\n          <Routes>\n          <Route path=\"*\" element={<ErrorNotFound />} />\n            <Route path=\"/\" element={<Main loggedIn={loggedIn} />} />\n            <Route path=\"/sign-in\" element={<Login onLogin={onLogin} />} />\n            <Route\n              path=\"/sign-up\"\n              element={<Register onRegister={onRegister} />}\n            />\n\n            <Route element={<ProtectedRoute loggedIn={loggedIn} />}>\n              <Route path=\"/movies\" element={<Movies />} />\n              <Route path=\"/saved-movies\" element={<SavedMovies />} />\n              <Route path=\"/profile\" element={<Profile \n              onUpdateUser={handleUpdateUser}\n                  onSignOut={onSignOut} />}\n              />\n              <Route path=\"nav-test\" element={<Navigation />} />\n            </Route>\n          </Routes>\n\n          <InfoToolTip\n            id=\"reg-pic\"\n            isOpened={isInfoToolTipOpened}\n            onClose={closeAllPopups}\n            isSuccseed={isSuccseed}\n          />\n        </div>\n      </isLoggedInContext.Provider>\n    </CurrentUserContext.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}